#include "besselj1_next.h"

/**********************************************************************************************************************************************************************************************************/
/**********************************************************************************************************************************************************************************************************/

//	DECLARATION DES CONSTANTES

#define PI 3.14159265358979

#define P1 1.e0
#define P2 .183105e-2
#define P3 -.3516396496e-4
#define P4 .2457520174e-5
#define P5 -.240337019e-6

#define Q1 .04687499995e0
#define Q2 -.2002690873e-3
#define Q3 .8449199096e-5
#define Q4 -.88228987e-6
#define Q5 .105787412e-6

#define R1 72362614232.e0
#define R2 -7895059235.e0
#define R3 242396853.1e0
#define R4 -2972611.439e0
#define R5 15704.48260e0
#define R6 -30.16036606e0

#define S1 144725228442.e0
#define S2 2300535178.e0
#define S3 18583304.74e0
#define S4 99447.43394e0
#define S5 376.9991397e0
#define S6 1.e0

/**********************************************************************************************************************************************************************************************************/
/**********************************************************************************************************************************************************************************************************/

double besselj1(double x)
{
  double ax,xx,y,z,signe,resultat;
  ax = (x<0) ? -x : x;
  signe = (x<0) ? -1. : 1.;
  
  if (ax<8.0)
  {
    y = x*x;
    resultat = x*(R1+y*(R2+y*(R3+y*(R4+y*(R5+y*R6)))))/
    (S1+y*(S2+y*(S3+y*(S4+y*(S5+y*S6)))));
    return resultat;
  }
  else
  {
    z  = 8./ax;
    y  = z*z;
    xx = ax - 2.356194491;
    resultat = sqrt(.636619772/ax)*
    ( cos(xx)*(P1+y*(P2+y*(P3+y*(P4+y*P5)))) - z*sin(xx)*(Q1+y*(Q2+y*(Q3+y*(Q4+y*Q5)))) );
    return (signe*resultat);
  }
}

/**********************************************************************************************************************************************************************************************************/
/**********************************************************************************************************************************************************************************************************/
