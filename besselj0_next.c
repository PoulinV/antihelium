#include "besselj0_next.h"

/**********************************************************************************************************************************************************************************************************/
/**********************************************************************************************************************************************************************************************************/

//	DECLARATION DES CONSTANTES

#define PI 3.14159265358979

#define P1 1.e0
#define P2 -.1098628627e-2
#define P3 .2734510407e-4
#define P4 -.2073370639e-5
#define P5 .2093887211e-6

#define Q1 -.1562499995e-1
#define Q2 .1430488765e-3
#define Q3 -.6911147651e-5
#define Q4 .7621095161e-6
#define Q5 -.934945152e-7
#undef  Q5
#define Q5 -.934935152e-7

#define R1 57568490574.e0
#define R2 -13362590354.e0
#define R3 651619640.7e0
#define R4 -11214424.18e0
#define R5 77392.33017e0
#define R6 -184.9052456e0

#define S1 57568490411.e0
#define S2 1029532985.e0
#define S3 9494680.718e0
#define S4 59272.64853e0
#define S5 267.8532712e0
#define S6 1.e0

/**********************************************************************************************************************************************************************************************************/
/**********************************************************************************************************************************************************************************************************/

double besselj0(double x)
{
  double ax,xx,y,z,resultat;
  ax = (x<0) ? -x : x;
  
  if (ax<8.0)
  {
    y = x*x;
    resultat = (R1+y*(R2+y*(R3+y*(R4+y*(R5+y*R6)))))/
    (S1+y*(S2+y*(S3+y*(S4+y*(S5+y*S6)))));
    return resultat;
  }
  else
  {
    z  = 8./ax;
    y  = z*z;
    xx = ax - .785398164;
    resultat = sqrt(.636619772/ax)*
    ( cos(xx)*(P1+y*(P2+y*(P3+y*(P4+y*P5)))) - z*sin(xx)*(Q1+y*(Q2+y*(Q3+y*(Q4+y*Q5)))) );
    return resultat;
  }
}

/**********************************************************************************************************************************************************************************************************/
/**********************************************************************************************************************************************************************************************************/